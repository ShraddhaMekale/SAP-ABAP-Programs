# PROGRAM FOR INNER JOIN

REPORT Z_INNERJOIN1.

*TABLES : MARA, MALT.

TYPES : BEGIN OF TY_FINAL,
        MATNR TYPE MARA-MATNR,
        ERSDA TYPE MARA-ERSDA,
        ERNAM TYPE MARA-ERNAM,
        MBREF TYPE T134-MBREF,
        MTREF TYPE T134-MTREF,
        END OF TY_FINAL.

DATA : A TYPE I,
       WA TYPE TY_FINAL,
       ITAB LIKE TABLE OF WA.

START-OF-SELECTION.

SELECT A~MATNR A~ERSDA A~ERNAM
       B~MBREF B~MTREF

  FROM MARA AS A INNER JOIN T134 AS B
  ON A~MTART = B~MBREF
  INTO TABLE ITAB

ORDER BY A~MTART ASCENDING.
  DELETE ADJACENT DUPLICATES FROM ITAB COMPARING MATNR.

*
*WRITE : SY-DBCNT.

LOOP AT ITAB INTO WA.

WRITE : / WA-MATNR, WA-ERSDA, WA-ERNAM, WA-MBREF, WA-MTREF.

  A = A + 1.

ENDLOOP.

WRITE : / A.